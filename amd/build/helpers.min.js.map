{"version":3,"sources":["../src/helpers.js"],"names":["define","$","yui","Notification","Str","elementTag","elementFaClass","elementActionReversed","init","initElementTag","initElementFAClass","initElementActionReversed","updateData","data","self","reversedaction","elementid","link","button","buttondatatext","buttondatatag","action","stringsToRetrieve","key","component","get_strings","done","s","elementId","target","recordingid","attr","find","updateDataCompatible","buttondatasrc","replace","updateId","id","removeAttr","play","publish","unpublish","protect","unprotect","edit","process","reloadPreview","thumbnails","each","thumbnail","thumbnailsrc","substring","indexOf","Date","getTime","capitalize","charAt","toUpperCase","slice","alertError","message","title","alert"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package   mod_bigbluebuttonbn\n * @copyright 2020 onwards, Blindside Networks Inc\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author    David Pesce  (david.pesce [at] exputo [dt] com)\n\n * @module mod_bigbluebuttonbn/helpers\n*/\n\ndefine(['jquery', 'core/yui', 'core/notification', 'core/str'],\n    function ($, yui, Notification, Str) {\n        /**\n         * Declare variables.\n         */\n        var elementTag = {};\n        var elementFaClass = {};\n        var elementActionReversed = {};\n\n        var Helpers = {\n            /**\n             * Initialise helpers code.\n             *\n             * @method init\n             */\n            init: function () {\n                elementTag = this.initElementTag();\n                elementFaClass = this.initElementFAClass();\n                elementActionReversed = this.initElementActionReversed();\n            },\n\n            /**\n             * Update the DOM.\n             *\n             * @param {Object} data\n             */\n            updateData: function (data) {\n                var self = this;\n                var reversedaction, elementid, link, button, buttondatatext, buttondatatag;\n                reversedaction = elementActionReversed[data.action];\n                if (reversedaction === data.action) {\n                    return;\n                }\n                var stringsToRetrieve = [\n                    {\n                        key: 'view_recording_list_actionbar_' + reversedaction,\n                        component: 'bigbluebuttonbn'\n                    }\n                ];\n                Str.get_strings(stringsToRetrieve)\n                    .done(function (s) {\n                        elementid = self.elementId(data.action, data.target);\n                        link = $('#' + elementid + '-' + data.recordingid);\n                        link.attr('data-action', reversedaction);\n\n                        buttondatatext = s[0];\n                        buttondatatag = elementTag[reversedaction];\n\n                        button = link.find('i');\n                        if (button === null) {\n                            // For backward compatibility.\n                            this.updateDataCompatible(link.find('img'), elementTag[data.action], buttondatatag, buttondatatext);\n                            return;\n                        }\n                        button.attr('data-aria-label', buttondatatext);\n                        button.attr('data-title', buttondatatext);\n                        button.attr('data-class', elementFaClass[reversedaction]);\n\n                    });\n            },\n\n            updateDataCompatible: function (button, action, buttondatatag, buttondatatext) {\n                if (button === null) {\n                    // Button doesn't have an icon.\n                    return;\n                }\n                var buttondatasrc = button.attr('data-src');\n                button.attr('data-alt', buttondatatext);\n                button.attr('data-title', buttondatatext);\n                button.attr('data-src', buttondatasrc.replace(buttondatatag, action));\n            },\n\n            updateId: function (data) {\n                var action, elementid, link, button, id;\n                action = elementActionReversed[data.action];\n                if (action === data.action) {\n                    return;\n                }\n                elementid = this.elementId(data.action, data.target);\n                link = $('a#' + elementid + '-' + data.recordingid);\n                id = '' + elementid.replace(data.action, action) + '-' + data.recordingid;\n                link.attr('id', id);\n                button = link.find('i');\n                if (button === null) {\n                    // For backward compatibility.\n                    button = link.find('img');\n                }\n                button.removeAttr('id');\n            },\n\n            elementId: function (action, target) {\n                var elementid = 'recording-' + action;\n                if (typeof target !== 'undefined') {\n                    elementid += '-' + target;\n                }\n                return elementid;\n            },\n\n            initElementTag: function () {\n                var tags = {};\n                tags.play = 'play';\n                tags.publish = 'hide';\n                tags.unpublish = 'show';\n                tags.protect = 'lock';\n                tags.unprotect = 'unlock';\n                tags.edit = 'edit';\n                tags.process = 'process';\n                tags['import'] = 'import';\n                tags['delete'] = 'delete';\n                return tags;\n            },\n\n            initElementFAClass: function () {\n                var tags = {};\n                tags.publish = 'icon fa fa-eye-slash fa-fw iconsmall';\n                tags.unpublish = 'icon fa fa-eye fa-fw iconsmall';\n                tags.protect = 'icon fa fa-unlock fa-fw iconsmall';\n                tags.unprotect = 'icon fa fa-lock fa-fw iconsmall';\n                tags.edit = 'icon fa fa-pencil fa-fw iconsmall';\n                tags.process = 'icon fa fa-spinner fa-spin iconsmall';\n                tags['import'] = 'icon fa fa-download fa-fw iconsmall';\n                tags['delete'] = 'icon fa fa-trash fa-fw iconsmall';\n                return tags;\n            },\n\n            initElementActionReversed: function () {\n                var actions = {};\n                actions.play = 'play';\n                actions.publish = 'unpublish';\n                actions.unpublish = 'publish';\n                actions.protect = 'unprotect';\n                actions.unprotect = 'protect';\n                actions.edit = 'edit';\n                actions['import'] = 'import';\n                actions['delete'] = 'delete';\n                return actions;\n            },\n\n            reloadPreview: function (recordingid) {\n                var thumbnails = $('#preview-' + recordingid).find('img');\n                thumbnails.each(function (thumbnail) {\n                    var thumbnailsrc = thumbnail.attr('src');\n                    thumbnailsrc = thumbnailsrc.substring(0, thumbnailsrc.indexOf('?'));\n                    thumbnailsrc += '?' + new Date().getTime();\n                    thumbnail.attr('src', thumbnailsrc);\n                });\n            },\n\n            capitalize: function (s) {\n                return s.charAt(0).toUpperCase() + s.slice(1);\n            },\n\n            alertError: function (message, title) {\n                if (typeof title == 'undefined') {\n                    title = 'Error';\n                }\n                Notification.alert(title, message, 'Continue');\n            }\n        };\n\n        return Helpers;\n\n    });"],"file":"helpers.min.js"}