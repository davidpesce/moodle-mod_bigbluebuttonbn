{"version":3,"sources":["../src/helpers.js"],"names":["define","$","yui","Notification","Str","elementTag","elementFaClass","elementActionReversed","init","initElementTag","initElementFAClass","initElementActionReversed","updateData","data","self","reversedaction","elementid","link","button","buttondatatext","buttondatatag","id","action","stringsToRetrieve","key","component","get_strings","then","s","elementId","target","recordingid","attr","replace","find","updateDataCompatible","buttondatasrc","play","publish","unpublish","protect","unprotect","edit","process","reloadPreview","thumbnails","each","thumbnail","thumbnailsrc","substring","indexOf","Date","getTime","capitalize","charAt","toUpperCase","slice","alertError","message","title","alert"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package   mod_bigbluebuttonbn\n * @copyright 2020 onwards, Blindside Networks Inc\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author    David Pesce  (david.pesce [at] exputo [dt] com)\n\n * @module mod_bigbluebuttonbn/helpers\n*/\n\ndefine(['jquery', 'core/yui', 'core/notification', 'core/str'],\n    function ($, yui, Notification, Str) {\n        /**\n         * Declare variables.\n         */\n        var elementTag = {};\n        var elementFaClass = {};\n        var elementActionReversed = {};\n\n        var Helpers = {\n            /**\n             * Initialise helpers code.\n             *\n             * @method init\n             */\n            init: function () {\n                elementTag = this.initElementTag();\n                elementFaClass = this.initElementFAClass();\n                elementActionReversed = this.initElementActionReversed();\n            },\n\n            /**\n             * Update the DOM.\n             *\n             * @param {Object} data\n             */\n            updateData: function (data) {\n                var self = this;\n                var reversedaction, elementid, link, button, buttondatatext, buttondatatag, id;\n                reversedaction = elementActionReversed[data.action];\n                if (reversedaction === data.action) {\n                    return;\n                }\n                var stringsToRetrieve = [\n                    {\n                        key: 'view_recording_list_actionbar_' + reversedaction,\n                        component: 'bigbluebuttonbn'\n                    }\n                ];\n                Str.get_strings(stringsToRetrieve)\n                    .then(function (s) {\n                        elementid = self.elementId(data.action, data.target);\n\n                        //Reverse the data-action.\n                        link = $('#' + elementid + '-' + data.recordingid);\n                        link.attr('data-action', reversedaction);\n\n                        //Reverse the action in the ID.\n                        id = '' + elementid.replace(data.action, reversedaction) + '-' + data.recordingid;\n                        link.attr('id', id);\n\n                        //Reverse the action icon.\n                        buttondatatext = s[0];\n                        buttondatatag = elementTag[reversedaction];\n\n                        button = link.find('i');\n                        if (button === null) {\n                            // For backward compatibility.\n                            this.updateDataCompatible(link.find('img'), elementTag[data.action], buttondatatag, buttondatatext);\n                            return;\n                        }\n                        button.attr('data-aria-label', buttondatatext);\n                        button.attr('data-title', buttondatatext);\n                        button.attr('data-class', elementFaClass[reversedaction]);\n                    });\n            },\n\n            updateDataCompatible: function (button, action, buttondatatag, buttondatatext) {\n                if (button === null) {\n                    // Button doesn't have an icon.\n                    return;\n                }\n                var buttondatasrc = button.attr('data-src');\n                button.attr('data-alt', buttondatatext);\n                button.attr('data-title', buttondatatext);\n                button.attr('data-src', buttondatasrc.replace(buttondatatag, action));\n            },\n\n            elementId: function (action, target) {\n                var elementid = 'recording-' + action;\n                if (typeof target !== 'undefined') {\n                    elementid += '-' + target;\n                }\n                return elementid;\n            },\n\n            initElementTag: function () {\n                var tags = {};\n                tags.play = 'play';\n                tags.publish = 'hide';\n                tags.unpublish = 'show';\n                tags.protect = 'lock';\n                tags.unprotect = 'unlock';\n                tags.edit = 'edit';\n                tags.process = 'process';\n                tags['import'] = 'import';\n                tags['delete'] = 'delete';\n                return tags;\n            },\n\n            initElementFAClass: function () {\n                var tags = {};\n                tags.publish = 'icon fa fa-eye-slash fa-fw iconsmall';\n                tags.unpublish = 'icon fa fa-eye fa-fw iconsmall';\n                tags.protect = 'icon fa fa-unlock fa-fw iconsmall';\n                tags.unprotect = 'icon fa fa-lock fa-fw iconsmall';\n                tags.edit = 'icon fa fa-pencil fa-fw iconsmall';\n                tags.process = 'icon fa fa-spinner fa-spin iconsmall';\n                tags['import'] = 'icon fa fa-download fa-fw iconsmall';\n                tags['delete'] = 'icon fa fa-trash fa-fw iconsmall';\n                return tags;\n            },\n\n            initElementActionReversed: function () {\n                var actions = {};\n                actions.play = 'play';\n                actions.publish = 'unpublish';\n                actions.unpublish = 'publish';\n                actions.protect = 'unprotect';\n                actions.unprotect = 'protect';\n                actions.edit = 'edit';\n                actions['import'] = 'import';\n                actions['delete'] = 'delete';\n                return actions;\n            },\n\n            reloadPreview: function (recordingid) {\n                var thumbnails = $('#preview-' + recordingid).find('img');\n                thumbnails.each(function (thumbnail) {\n                    var thumbnailsrc = thumbnail.attr('src');\n                    thumbnailsrc = thumbnailsrc.substring(0, thumbnailsrc.indexOf('?'));\n                    thumbnailsrc += '?' + new Date().getTime();\n                    thumbnail.attr('src', thumbnailsrc);\n                });\n            },\n\n            capitalize: function (s) {\n                return s.charAt(0).toUpperCase() + s.slice(1);\n            },\n\n            alertError: function (message, title) {\n                if (typeof title == 'undefined') {\n                    title = 'Error';\n                }\n                Notification.alert(title, message, 'Continue');\n            }\n        };\n\n        return Helpers;\n\n    });"],"file":"helpers.min.js"}