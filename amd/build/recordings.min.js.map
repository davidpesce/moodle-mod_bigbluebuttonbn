{"version":3,"sources":["../src/recordings.js"],"names":["define","$","mdlcfg","str","Helpers","yui","ModalFactory","ModalEvents","datasource","SELECTORS","FORM_SEARCH_RECORDINGS","SEARCH_TEXT","RECORDING_IMPORTED","init","self","wwwroot","sesskey","each","i","val","click","recordingDelete","recordingElementPayload","element","parent_div","closest","action","attr","recordingid","meetingid","recordingAction","confirmation","extras","payload","attrname","recordingActionPerform","create","type","types","SAVE_CANCEL","title","body","recordingConfirmationMessage","then","modal","setSaveButtonText","getRoot","on","save","show","data","qs","recordingActionMetaQS","attempt","attempts","getJSON","url","done","status","recordingActionFailover","goalstate","recordingActionCompletion","recordingActionPerformedComplete","recordingActionPerformedValidate","fail","error","message","source","meta","encodeURIComponent","JSON","stringify","setTimeout","get_string","e","recordingCurrentState","published","secured","updated","recordingPublish","recordingUnpublish","recordingProtect","recordingUnprotect","requireConfirmation","recordingIsImported","recordingImport","recordingUpdate","nodeelement","Y","one","node","ancestor","target","getAttribute","recordingEdit","link","text","hide","inputtext","Node","setAttribute","getHTML","recordingEditKeydown","recordingEditOnfocusout","append","focus","select","event","keyCode","which","recordingEditPerform","currentTarget","get","trim","getDOMNode","setHTML","recordingEditCompletion","failed","elementid","elementId","remove","recordingPlay","alertError","M","util","dataset","getData","windowVideoPlay","window","open","opener","recordingType","associatedLinks","confirmationWarning","imported","replace","links","container","table","row","all","size","prepend","toggleSpinningWheelOff","location","href","updateData","updateId","recordingPublishCompletion","recordingUnpublishCompletion","playbacks","preview","reloadPreview","prop"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package   mod_bigbluebuttonbn\n * @copyright 2020 onwards, Blindside Networks Inc\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author    David Pesce  (david.pesce [at] exputo [dt] com)\n\n * @module mod_bigbluebuttonbn/recordings\n*/\n\ndefine(['jquery', 'core/config', 'core/str', 'mod_bigbluebuttonbn/helpers',\n    'core/yui', 'core/modal_factory', 'core/modal_events'],\n    function ($, mdlcfg, str, Helpers, yui, ModalFactory, ModalEvents) {\n\n        /**\n         * Declare variables.\n         */\n        var datasource = null;\n\n        /**\n         * jQuery selectors.\n         */\n        var SELECTORS = {\n            FORM_SEARCH_RECORDINGS: '#bigbluebuttonbn_recordings_searchform',\n            SEARCH_TEXT: '#searchtext',\n            RECORDING_IMPORTED: 'data-imported'\n        };\n\n        var Recordings = {\n            /**\n            * Initialize recording display.\n            */\n            init: function () {\n                var self = this;\n                datasource = mdlcfg.wwwroot + \"/mod/bigbluebuttonbn/bbb_ajax.php?sesskey=\" + mdlcfg.sesskey + \"&\";\n\n                //Add onclick event listeners to delete buttons\n                $('[id^=recording-delete-]').each(function (i, val) {\n                    $(val).click(function () {\n                        self.recordingDelete(val);\n                    });\n                });\n\n                Helpers.init();\n            },\n\n            recordingElementPayload: function (element) {\n                var parent_div = $(element).closest('div');\n                return {\n                    action: $(element).attr('data-action'),\n                    recordingid: parent_div.attr('data-recordingid'),\n                    meetingid: parent_div.attr('data-meetingid')\n                };\n            },\n\n            recordingAction: function (element, confirmation, extras) {\n                var self = this;\n                var payload = this.recordingElementPayload(element);\n                for (var attrname in extras) {\n                    payload[attrname] = extras[attrname];\n                }\n                // The action doesn't require confirmation.\n                if (!confirmation) {\n                    this.recordingActionPerform(payload);\n                    return;\n                }\n\n                // Create the confirmation dialogue.\n                ModalFactory.create({\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    title: 'Are you sure?',\n                    body: self.recordingConfirmationMessage(payload)\n                })\n                    .then(function (modal) {\n                        modal.setSaveButtonText('Delete');\n                        modal.getRoot().on(ModalEvents.save, function () {\n                            self.recordingActionPerform(payload);\n                        });\n                        modal.show();\n                    });\n            },\n\n            recordingActionPerform: function (data) {\n                var self = this;\n                var qs = \"action=recording_\" + data.action + \"&id=\" + data.recordingid + \"&idx=\" + data.meetingid;\n                qs += this.recordingActionMetaQS(data);\n                data.attempt = 1;\n                if (typeof data.attempts === 'undefined') {\n                    data.attempts = 5;\n                }\n                $.getJSON({\n                    url: datasource + qs\n                })\n                    .done(function (data) {\n                        // Something went wrong.\n                        if (!data.status) {\n                            return self.recordingActionFailover(data);\n                        }\n                        // There is no need for verification.\n                        if (typeof data.goalstate === 'undefined') {\n                            return self.recordingActionCompletion(data);\n                        }\n                        // Use the current response for verification.\n                        if (data.attempts <= 1) {\n                            return self.recordingActionPerformedComplete(data);\n                        }\n                        // Iterate the verification.\n                        return self.recordingActionPerformedValidate(data);\n                    })\n                    .fail(function (error) {\n                        data.message = error.message;\n                        return self.recordingActionFailover(data);\n                    });\n            },\n\n            recordingActionMetaQS: function (data) {\n                var qs = '';\n                if (typeof data.source !== 'undefined') {\n                    var meta = {};\n                    meta[data.source] = encodeURIComponent(data.goalstate);\n                    qs += \"&meta=\" + JSON.stringify(meta);\n                }\n                return qs;\n            },\n\n            recordingActionPerformedValidate: function (data) {\n                var self = this;\n                var qs = \"action=recording_info&id=\" + data.recordingid + \"&idx=\" + data.meetingid;\n                qs += this.recordingActionMetaQS(data);\n                $.getJSON({\n                    url: datasource + qs\n                })\n                    .done(function (data) {\n                        // Evaluates if the current attempt has been completed.\n                        if (self.recordingActionPerformedComplete(data)) {\n                            // It has been completed, so stop the action.\n                            return;\n                        }\n                        // Evaluates if more attempts have to be performed.\n                        if (data.attempt < data.attempts) {\n                            data.attempt += 1;\n                            setTimeout(((function () {\n                                return function () {\n                                    self.recordingActionPerformedValidate(data);\n                                };\n                            })(this)), (data.attempt - 1) * 1000);\n                            return;\n                        }\n                        // No more attempts to perform, it stops with failing over.\n                        data.message = str.get_string('view_error_action_not_completed', 'bigbluebuttonbn');\n                        self.recordingActionFailover(data);\n\n                    })\n                    .fail(function (error) {\n                        data.message = error.message;\n                        self.recordingActionFailover(data);\n                    });\n            },\n\n            recordingActionPerformedComplete: function (e, data) {\n                // Something went wrong.\n                if (typeof e.data[data.source] === 'undefined') {\n                    data.message = str.get_string('view_error_current_state_not_found', 'bigbluebuttonbn');\n                    self.recordingActionFailover(data);\n                    return true;\n                }\n                // Evaluates if the state is as expected.\n                if (e.data[data.source] === data.goalstate) {\n                    self.recordingActionCompletion(data);\n                    return true;\n                }\n                return false;\n            },\n\n            recordingCurrentState: function (action, data) {\n                if (action === 'publish' || action === 'unpublish') {\n                    return data.published;\n                }\n                if (action === 'delete') {\n                    return data.status;\n                }\n                if (action === 'protect' || action === 'unprotect') {\n                    return data.secured; // The broker responds with secured as protected is a reserverd word.\n                }\n                if (action === 'update') {\n                    return data.updated;\n                }\n                return null;\n            },\n\n            recordingPublish: function (element) {\n                var extras = {\n                    source: 'published',\n                    goalstate: 'true'\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingUnpublish: function (element) {\n                var extras = {\n                    source: 'published',\n                    goalstate: 'false'\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingProtect: function (element) {\n                var extras = {\n                    source: 'protected',\n                    goalstate: 'true'\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingUnprotect: function (element) {\n                var extras = {\n                    source: 'protected',\n                    goalstate: 'false'\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingDelete: function (element) {\n                var extras = {\n                    source: 'found',\n                    goalstate: false\n                };\n                var requireConfirmation = true;\n                if (this.recordingIsImported(element)) {\n                    // When recordingDelete is performed on imported recordings use default response for validation.\n                    requireConfirmation = false;\n                    extras.source = 'status';\n                    extras.goalstate = true;\n                    extras.attempts = 1;\n                }\n                this.recordingAction(element, requireConfirmation, extras);\n            },\n\n            recordingImport: function (element) {\n                var extras = {};\n                this.recordingAction(element, true, extras);\n            },\n\n            recordingUpdate: function (element) {\n                var nodeelement = Y.one(element);\n                var node = nodeelement.ancestor('div');\n                var extras = {\n                    target: node.getAttribute('data-target'),\n                    source: node.getAttribute('data-source'),\n                    goalstate: nodeelement.getAttribute('data-goalstate')\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingEdit: function (element) {\n                var link = Y.one(element);\n                var node = link.ancestor('div');\n                var text = node.one('> span');\n                text.hide();\n                link.hide();\n                var inputtext = Y.Node.create('<input type=\"text\" class=\"form-control\"></input>');\n                inputtext.setAttribute('id', link.getAttribute('id'));\n                inputtext.setAttribute('value', text.getHTML());\n                inputtext.setAttribute('data-value', text.getHTML());\n                inputtext.on('keydown', this.recordingEditKeydown);\n                inputtext.on('focusout', this.recordingEditOnfocusout);\n                node.append(inputtext);\n                inputtext.focus().select();\n            },\n\n            recordingEditKeydown: function (event) {\n                var keyCode = event.which || event.keyCode;\n                if (keyCode == 13) {\n                    this.recordingEditPerform(event.currentTarget);\n                    return;\n                }\n                if (keyCode == 27) {\n                    this.recordingEditOnfocusout(event.currentTarget);\n                }\n            },\n\n            recordingEditOnfocusout: function (nodeelement) {\n                var node = nodeelement.ancestor('div');\n                nodeelement.hide();\n                node.one('> span').show();\n                node.one('> a').show();\n            },\n\n            recordingEditPerform: function (nodeelement) {\n                var node = nodeelement.ancestor('div');\n                var text = nodeelement.get('value').trim();\n                // Perform the update.\n                nodeelement.setAttribute('data-action', 'edit');\n                nodeelement.setAttribute('data-goalstate', text);\n                nodeelement.hide();\n                this.recordingUpdate(nodeelement.getDOMNode());\n                node.one('> span').setHTML(text).show();\n                node.one('> a').show();\n            },\n\n            recordingEditCompletion: function (data, failed) {\n                var elementid = Helpers.elementId(data.action, data.target);\n                var link = Y.one('a#' + elementid + '-' + data.recordingid);\n                var node = link.ancestor('div');\n                var text = node.one('> span');\n                if (typeof text === 'undefined') {\n                    return;\n                }\n                var inputtext = node.one('> input');\n                if (failed) {\n                    text.setHTML(inputtext.getAttribute('data-value'));\n                }\n                inputtext.remove();\n            },\n\n            recordingPlay: function (element) {\n                var nodeelement = Y.one(element);\n                if (nodeelement.getAttribute('data-href') === '') {\n                    Helpers.alertError(\n                        M.util.get_string('view_recording_format_errror_unreachable', 'bigbluebuttonbn')\n                    );\n                    return;\n                }\n                var extras = {\n                    target: nodeelement.getAttribute('data-target'),\n                    source: 'published',\n                    goalstate: 'true',\n                    attempts: 1,\n                    dataset: nodeelement.getData()\n                };\n                // New window for video play must be created previous to ajax requests.\n                this.windowVideoPlay = window.open('', '_blank');\n                // Prevent malicious modification over window opener to use window.open().\n                this.windowVideoPlay.opener = null;\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingConfirmationMessage: function (data) {\n                var confirmation, recordingType, elementid, associatedLinks, confirmationWarning;\n                confirmation = M.util.get_string('view_recording_' + data.action + '_confirmation', 'bigbluebuttonbn');\n                if (typeof confirmation === 'undefined') {\n                    return '';\n                }\n                recordingType = M.util.get_string('view_recording', 'bigbluebuttonbn');\n                if (Y.one('#playbacks-' + data.recordingid).get('dataset').imported === 'true') {\n                    recordingType = M.util.get_string('view_recording_link', 'bigbluebuttonbn');\n                }\n                confirmation = confirmation.replace(\"{$a}\", recordingType);\n                if (data.action === 'import') {\n                    return confirmation;\n                }\n                // If it has associated links imported in a different course/activity, show that in confirmation dialog.\n                elementid = Helpers.elementId(data.action, data.target);\n                associatedLinks = Y.one('a#' + elementid + '-' + data.recordingid).get('dataset').links;\n                if (associatedLinks === 0) {\n                    return confirmation;\n                }\n                confirmationWarning = M.util.get_string('view_recording_' + data.action + '_confirmation_warning_p',\n                    'bigbluebuttonbn');\n                if (associatedLinks == 1) {\n                    confirmationWarning = M.util.get_string('view_recording_' + data.action + '_confirmation_warning_s',\n                        'bigbluebuttonbn');\n                }\n                confirmationWarning = confirmationWarning.replace(\"{$a}\", associatedLinks) + '. ';\n                return confirmationWarning + '\\n\\n' + confirmation;\n            },\n\n            recordingActionCompletion: function (data) {\n                var container, table, row;\n                if (data.action == 'delete') {\n                    row = Y.one('div#recording-actionbar-' + data.recordingid).ancestor('td').ancestor('tr');\n                    table = row.ancestor('tbody');\n                    if (table.all('tr').size() == 1) {\n                        container = Y.one('#bigbluebuttonbn_view_recordings_content');\n                        container.prepend('<span>' + M.util.get_string('view_message_norecordings', 'bigbluebuttonbn') + '</span>');\n                        container.one('#bigbluebuttonbn_recordings_table').remove();\n                        return;\n                    }\n                    row.remove();\n                    return;\n                }\n                if (data.action == 'import') {\n                    row = Y.one('div#recording-actionbar-' + data.recordingid).ancestor('td').ancestor('tr');\n                    row.remove();\n                    return;\n                }\n                if (data.action == 'play') {\n                    Helpers.toggleSpinningWheelOff(data);\n                    // Update url in window video to show the video.\n                    this.windowVideoPlay.location.href = data.dataset.href;\n                    return;\n                }\n                Helpers.updateData(data);\n                Helpers.toggleSpinningWheelOff(data);\n                Helpers.updateId(data);\n                if (data.action === 'publish') {\n                    this.recordingPublishCompletion(data.recordingid);\n                    return;\n                }\n                if (data.action === 'unpublish') {\n                    this.recordingUnpublishCompletion(data.recordingid);\n                    return;\n                }\n            },\n\n            recordingActionFailover: function (data) {\n                Helpers.alertError(data.message);\n                Helpers.toggleSpinningWheelOff(data);\n                if (data.action === 'edit') {\n                    this.recordingEditCompletion(data, true);\n                }\n            },\n\n            recordingPublishCompletion: function (recordingid) {\n                var playbacks = Y.one('#playbacks-' + recordingid);\n                playbacks.show();\n                var preview = Y.one('#preview-' + recordingid);\n                if (preview === null) {\n                    return;\n                }\n                preview.show();\n                Helpers.reloadPreview(recordingid);\n            },\n\n            recordingUnpublishCompletion: function (recordingid) {\n                var playbacks = Y.one('#playbacks-' + recordingid);\n                playbacks.hide();\n                var preview = Y.one('#preview-' + recordingid);\n                if (preview === null) {\n                    return;\n                }\n                preview.hide();\n            },\n\n            recordingIsImported: function (element) {\n                return $(element).prop(SELECTORS.RECORDING_IMPORTED);\n            }\n        };\n\n        return Recordings;\n\n    });"],"file":"recordings.min.js"}