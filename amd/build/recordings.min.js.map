{"version":3,"sources":["../src/recordings.js"],"names":["define","$","mdlcfg","str","Helpers","yui","ModalFactory","ModalEvents","datasource","SELECTORS","FORM_SEARCH_RECORDINGS","SEARCH_TEXT","RECORDING_IMPORTED","init","self","wwwroot","sesskey","each","i","val","click","recordingDelete","recordingElementPayload","element","parent_div","closest","action","attr","recordingid","meetingid","recordingAction","confirmation","extras","payload","attrname","recordingActionPerform","create","type","types","SAVE_CANCEL","title","body","recordingConfirmationMessage","then","modal","setSaveButtonText","getRoot","on","save","console","log","show","data","qs","recordingActionMetaQS","attempt","attempts","getJSON","url","done","status","recordingActionFailover","goalstate","recordingActionCompletion","recordingActionPerformedComplete","recordingActionPerformedValidate","fail","error","message","source","meta","encodeURIComponent","JSON","stringify","setTimeout","get_string","e","recordingCurrentState","published","secured","updated","recordingPublish","recordingUnpublish","recordingProtect","recordingUnprotect","requireConfirmation","recordingIsImported","recordingImport","recordingUpdate","nodeelement","Y","one","node","ancestor","target","getAttribute","recordingEdit","link","text","hide","inputtext","Node","setAttribute","getHTML","recordingEditKeydown","recordingEditOnfocusout","append","focus","select","event","keyCode","which","recordingEditPerform","currentTarget","get","trim","getDOMNode","setHTML","recordingEditCompletion","failed","elementid","elementId","remove","recordingPlay","alertError","M","util","dataset","getData","windowVideoPlay","window","open","opener","recordingType","associatedLinks","confirmationWarning","imported","replace","links","container","table","row","get_strings","key","component","s","children","length","before","toggleSpinningWheelOff","location","href","updateData","updateId","recordingPublishCompletion","recordingUnpublishCompletion","playbacks","preview","reloadPreview","prop"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package   mod_bigbluebuttonbn\n * @copyright 2020 onwards, Blindside Networks Inc\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author    David Pesce  (david.pesce [at] exputo [dt] com)\n\n * @module mod_bigbluebuttonbn/recordings\n*/\n\ndefine(['jquery', 'core/config', 'core/str', 'mod_bigbluebuttonbn/helpers',\n    'core/yui', 'core/modal_factory', 'core/modal_events'],\n    function ($, mdlcfg, str, Helpers, yui, ModalFactory, ModalEvents) {\n\n        /**\n         * Declare variables.\n         */\n        var datasource = null;\n\n        /**\n         * jQuery selectors.\n         */\n        var SELECTORS = {\n            FORM_SEARCH_RECORDINGS: '#bigbluebuttonbn_recordings_searchform',\n            SEARCH_TEXT: '#searchtext',\n            RECORDING_IMPORTED: 'data-imported'\n        };\n\n        var Recordings = {\n            /**\n            * Initialize recording display.\n            */\n            init: function () {\n                var self = this;\n                datasource = mdlcfg.wwwroot + \"/mod/bigbluebuttonbn/bbb_ajax.php?sesskey=\" + mdlcfg.sesskey + \"&\";\n\n                //Add onclick event listeners to delete buttons\n                $('[id^=recording-delete-]').each(function (i, val) {\n                    $(val).click(function () {\n                        self.recordingDelete(val);\n                    });\n                });\n\n                Helpers.init();\n            },\n\n            recordingElementPayload: function (element) {\n                var parent_div = $(element).closest('div');\n                return {\n                    action: $(element).attr('data-action'),\n                    recordingid: parent_div.attr('data-recordingid'),\n                    meetingid: parent_div.attr('data-meetingid')\n                };\n            },\n\n            recordingAction: function (element, confirmation, extras) {\n                var self = this;\n                var payload = this.recordingElementPayload(element);\n                for (var attrname in extras) {\n                    payload[attrname] = extras[attrname];\n                }\n                // The action doesn't require confirmation.\n                if (!confirmation) {\n                    self.recordingActionPerform(payload);\n                    return;\n                }\n\n                // Create the confirmation dialogue.\n                ModalFactory.create({\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    title: 'Are you sure?',\n                    body: self.recordingConfirmationMessage(payload)\n                })\n                    .then(function (modal) {\n                        modal.setSaveButtonText('Delete');\n                        modal.getRoot().on(ModalEvents.save, function () {\n                            console.log('clicked delete.')\n                            self.recordingActionPerform(payload);\n                        });\n                        modal.show();\n                    });\n            },\n\n            recordingActionPerform: function (data) {\n                var self = this;\n                var qs = \"action=recording_\" + data.action + \"&id=\" + data.recordingid + \"&idx=\" + data.meetingid;\n                qs += this.recordingActionMetaQS(data);\n                data.attempt = 1;\n                if (typeof data.attempts === 'undefined') {\n                    data.attempts = 5;\n                }\n                $.getJSON({\n                    url: datasource + qs\n                })\n                    .done(function (data) {\n                        // Something went wrong.\n                        console.log(data);\n                        if (!data.status) {\n                            console.log('failure:recordingActionPerform:!data.status');\n                            return self.recordingActionFailover(data);\n                        }\n                        // There is no need for verification.\n                        if (typeof data.goalstate === 'undefined') {\n                            return self.recordingActionCompletion(data);\n                        }\n                        // Use the current response for verification.\n                        if (data.attempts <= 1) {\n                            return self.recordingActionPerformedComplete(data);\n                        }\n                        // Iterate the verification.\n                        return self.recordingActionPerformedValidate(data);\n                    })\n                    .fail(function (error) {\n                        console.log(error);\n                        data.message = error.message;\n                        console.log(data);\n                        console.log('failure:recordingActionPerform:getJSON.failure');\n                        return self.recordingActionFailover(data);\n                    });\n            },\n\n            recordingActionMetaQS: function (data) {\n                var qs = '';\n                if (typeof data.source !== 'undefined') {\n                    var meta = {};\n                    meta[data.source] = encodeURIComponent(data.goalstate);\n                    qs += \"&meta=\" + JSON.stringify(meta);\n                }\n                return qs;\n            },\n\n            recordingActionPerformedValidate: function (data) {\n                var self = this;\n                var qs = \"action=recording_info&id=\" + data.recordingid + \"&idx=\" + data.meetingid;\n                qs += this.recordingActionMetaQS(data);\n                $.getJSON({\n                    url: datasource + qs\n                })\n                    .done(function (data) {\n                        // Evaluates if the current attempt has been completed.\n                        if (self.recordingActionPerformedComplete(data)) {\n                            // It has been completed, so stop the action.\n                            return;\n                        }\n                        // Evaluates if more attempts have to be performed.\n                        if (data.attempt < data.attempts) {\n                            data.attempt += 1;\n                            setTimeout(((function () {\n                                return function () {\n                                    self.recordingActionPerformedValidate(data);\n                                };\n                            })(this)), (data.attempt - 1) * 1000);\n                            return;\n                        }\n                        // No more attempts to perform, it stops with failing over.\n                        data.message = str.get_string('view_error_action_not_completed', 'bigbluebuttonbn');\n                        console.log('failure:recordingActionPerformedValidate:nomoreattempts');\n                        self.recordingActionFailover(data);\n\n                    })\n                    .fail(function (error) {\n                        data.message = error.message;\n                        console.log('failure:recordingActionPerformedValidate:getJSONfailure');\n                        self.recordingActionFailover(data);\n                    });\n            },\n\n            recordingActionPerformedComplete: function (e, data) {\n                // Something went wrong.\n                if (typeof e.data[data.source] === 'undefined') {\n                    data.message = str.get_string('view_error_current_state_not_found', 'bigbluebuttonbn');\n                    console.log('failure:recordingActionPerformedComplete:somethingwentwrong');\n                    self.recordingActionFailover(data);\n                    return true;\n                }\n                // Evaluates if the state is as expected.\n                if (e.data[data.source] === data.goalstate) {\n                    self.recordingActionCompletion(data);\n                    return true;\n                }\n                return false;\n            },\n\n            recordingCurrentState: function (action, data) {\n                if (action === 'publish' || action === 'unpublish') {\n                    return data.published;\n                }\n                if (action === 'delete') {\n                    return data.status;\n                }\n                if (action === 'protect' || action === 'unprotect') {\n                    return data.secured; // The broker responds with secured as protected is a reserverd word.\n                }\n                if (action === 'update') {\n                    return data.updated;\n                }\n                return null;\n            },\n\n            recordingPublish: function (element) {\n                var extras = {\n                    source: 'published',\n                    goalstate: 'true'\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingUnpublish: function (element) {\n                var extras = {\n                    source: 'published',\n                    goalstate: 'false'\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingProtect: function (element) {\n                var extras = {\n                    source: 'protected',\n                    goalstate: 'true'\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingUnprotect: function (element) {\n                var extras = {\n                    source: 'protected',\n                    goalstate: 'false'\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingDelete: function (element) {\n                var extras = {\n                    source: 'found',\n                    goalstate: false\n                };\n                var requireConfirmation = true;\n                if (this.recordingIsImported(element)) {\n                    // When recordingDelete is performed on imported recordings use default response for validation.\n                    requireConfirmation = false;\n                    extras.source = 'status';\n                    extras.goalstate = true;\n                    extras.attempts = 1;\n                }\n                this.recordingAction(element, requireConfirmation, extras);\n            },\n\n            recordingImport: function (element) {\n                var extras = {};\n                this.recordingAction(element, true, extras);\n            },\n\n            recordingUpdate: function (element) {\n                var nodeelement = Y.one(element);\n                var node = nodeelement.ancestor('div');\n                var extras = {\n                    target: node.getAttribute('data-target'),\n                    source: node.getAttribute('data-source'),\n                    goalstate: nodeelement.getAttribute('data-goalstate')\n                };\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingEdit: function (element) {\n                var link = Y.one(element);\n                var node = link.ancestor('div');\n                var text = node.one('> span');\n                text.hide();\n                link.hide();\n                var inputtext = Y.Node.create('<input type=\"text\" class=\"form-control\"></input>');\n                inputtext.setAttribute('id', link.getAttribute('id'));\n                inputtext.setAttribute('value', text.getHTML());\n                inputtext.setAttribute('data-value', text.getHTML());\n                inputtext.on('keydown', this.recordingEditKeydown);\n                inputtext.on('focusout', this.recordingEditOnfocusout);\n                node.append(inputtext);\n                inputtext.focus().select();\n            },\n\n            recordingEditKeydown: function (event) {\n                var keyCode = event.which || event.keyCode;\n                if (keyCode == 13) {\n                    this.recordingEditPerform(event.currentTarget);\n                    return;\n                }\n                if (keyCode == 27) {\n                    this.recordingEditOnfocusout(event.currentTarget);\n                }\n            },\n\n            recordingEditOnfocusout: function (nodeelement) {\n                var node = nodeelement.ancestor('div');\n                nodeelement.hide();\n                node.one('> span').show();\n                node.one('> a').show();\n            },\n\n            recordingEditPerform: function (nodeelement) {\n                var node = nodeelement.ancestor('div');\n                var text = nodeelement.get('value').trim();\n                // Perform the update.\n                nodeelement.setAttribute('data-action', 'edit');\n                nodeelement.setAttribute('data-goalstate', text);\n                nodeelement.hide();\n                this.recordingUpdate(nodeelement.getDOMNode());\n                node.one('> span').setHTML(text).show();\n                node.one('> a').show();\n            },\n\n            recordingEditCompletion: function (data, failed) {\n                var elementid = Helpers.elementId(data.action, data.target);\n                var link = Y.one('a#' + elementid + '-' + data.recordingid);\n                var node = link.ancestor('div');\n                var text = node.one('> span');\n                if (typeof text === 'undefined') {\n                    return;\n                }\n                var inputtext = node.one('> input');\n                if (failed) {\n                    text.setHTML(inputtext.getAttribute('data-value'));\n                }\n                inputtext.remove();\n            },\n\n            recordingPlay: function (element) {\n                var nodeelement = Y.one(element);\n                if (nodeelement.getAttribute('data-href') === '') {\n                    Helpers.alertError(\n                        M.util.get_string('view_recording_format_errror_unreachable', 'bigbluebuttonbn')\n                    );\n                    return;\n                }\n                var extras = {\n                    target: nodeelement.getAttribute('data-target'),\n                    source: 'published',\n                    goalstate: 'true',\n                    attempts: 1,\n                    dataset: nodeelement.getData()\n                };\n                // New window for video play must be created previous to ajax requests.\n                this.windowVideoPlay = window.open('', '_blank');\n                // Prevent malicious modification over window opener to use window.open().\n                this.windowVideoPlay.opener = null;\n                this.recordingAction(element, false, extras);\n            },\n\n            recordingConfirmationMessage: function (data) {\n                var confirmation, recordingType, elementid, associatedLinks, confirmationWarning;\n                confirmation = M.util.get_string('view_recording_' + data.action + '_confirmation', 'bigbluebuttonbn');\n                if (typeof confirmation === 'undefined') {\n                    return '';\n                }\n                recordingType = M.util.get_string('view_recording', 'bigbluebuttonbn');\n                if (Y.one('#playbacks-' + data.recordingid).get('dataset').imported === 'true') {\n                    recordingType = M.util.get_string('view_recording_link', 'bigbluebuttonbn');\n                }\n                confirmation = confirmation.replace(\"{$a}\", recordingType);\n                if (data.action === 'import') {\n                    return confirmation;\n                }\n                // If it has associated links imported in a different course/activity, show that in confirmation dialog.\n                elementid = Helpers.elementId(data.action, data.target);\n                associatedLinks = Y.one('a#' + elementid + '-' + data.recordingid).get('dataset').links;\n                if (associatedLinks === 0) {\n                    return confirmation;\n                }\n                confirmationWarning = M.util.get_string('view_recording_' + data.action + '_confirmation_warning_p',\n                    'bigbluebuttonbn');\n                if (associatedLinks == 1) {\n                    confirmationWarning = M.util.get_string('view_recording_' + data.action + '_confirmation_warning_s',\n                        'bigbluebuttonbn');\n                }\n                confirmationWarning = confirmationWarning.replace(\"{$a}\", associatedLinks) + '. ';\n                return confirmationWarning + '\\n\\n' + confirmation;\n            },\n\n            recordingActionCompletion: function (data) {\n                var container, table, row;\n                var stringsToRetrieve = [\n                    {\n                        key: 'view_message_norecordings',\n                        component: 'bigbluebuttonbn'\n                    }\n                ];\n\n                if (data.action === 'delete') {\n                    str.get_strings(stringsToRetrieve)\n                        .done(function (s) {\n                            //row = Y.one('div#recording-actionbar-' + data.recordingid).ancestor('td').ancestor('tr');\n                            row = $('div#recording-actionbar-' + data.recordingid).closest('td').closest('tr');\n\n                            //table = row.ancestor('tbody');\n                            table = row.closest('tbody');\n\n                            //if (table.all('tr').size() === 1) {\n                            if (table.children('tr').length) {\n                                //container = Y.one('#bigbluebuttonbn_view_recordings_content');\n                                container = $('#bigbluebuttonbn_view_recordings_content');\n\n                                //container.prepend('<span>' + s + '</span>');\n                                container.before('<span>' + s + '</span>');\n\n                                //container.one('#bigbluebuttonbn_recordings_table').remove();\n                                $('#bigbluebuttonbn_recordings_table').remove();\n                                return;\n                            }\n                            row.remove();\n                            return;\n                        });\n\n                }\n                if (data.action === 'import') {\n                    row = Y.one('div#recording-actionbar-' + data.recordingid).ancestor('td').ancestor('tr');\n                    row.remove();\n                    return;\n                }\n                if (data.action === 'play') {\n                    Helpers.toggleSpinningWheelOff(data);\n                    // Update url in window video to show the video.\n                    this.windowVideoPlay.location.href = data.dataset.href;\n                    return;\n                }\n                Helpers.updateData(data);\n                Helpers.toggleSpinningWheelOff(data);\n                Helpers.updateId(data);\n                if (data.action === 'publish') {\n                    this.recordingPublishCompletion(data.recordingid);\n                    return;\n                }\n                if (data.action === 'unpublish') {\n                    this.recordingUnpublishCompletion(data.recordingid);\n                    return;\n                }\n            },\n\n            recordingActionFailover: function (data) {\n                Helpers.alertError(data.message);\n                Helpers.toggleSpinningWheelOff(data);\n                if (data.action === 'edit') {\n                    this.recordingEditCompletion(data, true);\n                }\n            },\n\n            recordingPublishCompletion: function (recordingid) {\n                var playbacks = Y.one('#playbacks-' + recordingid);\n                playbacks.show();\n                var preview = Y.one('#preview-' + recordingid);\n                if (preview === null) {\n                    return;\n                }\n                preview.show();\n                Helpers.reloadPreview(recordingid);\n            },\n\n            recordingUnpublishCompletion: function (recordingid) {\n                var playbacks = Y.one('#playbacks-' + recordingid);\n                playbacks.hide();\n                var preview = Y.one('#preview-' + recordingid);\n                if (preview === null) {\n                    return;\n                }\n                preview.hide();\n            },\n\n            recordingIsImported: function (element) {\n                return $(element).prop(SELECTORS.RECORDING_IMPORTED);\n            }\n        };\n\n        return Recordings;\n\n    });"],"file":"recordings.min.js"}